# ─── Required ─────────────────────────────────────────────────────────────────

# Your bridge's public domain (must be HTTPS in production)
LOCAL_DOMAIN=https://klistr.example.com

# Your Nostr hex private key — keep this safe!
# This is your real identity; all bridged posts will be signed with this key.
NOSTR_PRIVATE_KEY=

# Your handle on this bridge (e.g. alice → alice@klistr.example.com)
# Defaults to the first 8 characters of your public key if not set.
NOSTR_USERNAME=

# ─── Nostr Relays ─────────────────────────────────────────────────────────────

# Comma-separated relay list. Fully manageable via /web admin UI at runtime.
# You can omit this entirely once you've configured relays in the dashboard.
NOSTR_RELAY=wss://relay.mostr.pub

# ─── Profile metadata ─────────────────────────────────────────────────────────
# All of these are also editable live via /web admin UI (no restart needed).

# NOSTR_DISPLAY_NAME=Alice
# NOSTR_SUMMARY=My profile bio
# NOSTR_PICTURE=https://example.com/avatar.jpg
# NOSTR_BANNER=https://example.com/banner.jpg

# ─── Database ─────────────────────────────────────────────────────────────────

# SQLite (default — no external dependencies):
DATABASE_URL=klistr.db

# PostgreSQL (for larger deployments):
# DATABASE_URL=postgresql://user:password@localhost:5432/klistr

# ─── Web admin UI ─────────────────────────────────────────────────────────────

# Set a password to enable the dashboard at /web (HTTP Basic Auth).
# Omit entirely to disable the admin UI.
# WEB_ADMIN=changeme

# ─── Bluesky bridge (optional) ────────────────────────────────────────────────
# Both must be set to enable the Bluesky bridge. Restart required to change.

# BSKY_IDENTIFIER=yourdomain.com       # your Bluesky handle or DID
# BSKY_APP_PASSWORD=xxxx-xxxx-xxxx-xxxx # Settings → App Passwords

# Bridge posts from Bluesky accounts you follow into your Nostr feed.
# Enabled by default. Set to false to receive only interactions targeting you.
# BSKY_BRIDGE_TIMELINE=false

# Custom PDS endpoint (default: https://bsky.social).
# Only needed for third-party PDS accounts or did:web identities.
# BSKY_PDS_URL=https://bsky.social

# ─── Optional ─────────────────────────────────────────────────────────────────

# Whether to sign outbound HTTP requests (recommended: true)
SIGN_FETCH=true

# Append the original post URL at the bottom of bridged notes.
# Also toggleable live via /web admin UI.
# SHOW_SOURCE_LINK=false

# External Nostr URL resolver used in Bluesky post truncation links.
# Also editable via /web admin UI.
EXTERNAL_BASE_URL=https://njump.me

# Log level: info (default) or debug
LOG_LEVEL=info

# Lightning zap splitting (optional — also editable via /web admin UI)
# ZAP_PUBKEY=<hex-pubkey>
# ZAP_SPLIT=0.1

# ─── Performance tuning (rarely need changing) ────────────────────────────────

# How often bridged AP actor profiles are re-fetched and re-published (default: 24h)
# RESYNC_INTERVAL=24h

# TTL for the AP object and WebFinger in-memory caches (default: 1h)
# AP_CACHE_TTL=1h

# How often Bluesky notifications and timeline are polled (default: 30s)
# BSKY_POLL_INTERVAL=30s

# Max concurrent outbound ActivityPub HTTP delivery requests (default: 10)
# AP_FEDERATION_CONCURRENCY=10

# Consecutive relay publish failures before the circuit breaker opens (default: 3)
# RELAY_CB_THRESHOLD=3
